
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/newBie/NewBieGift.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'ff138Fh57NHHqstEbjYQe72', 'NewBieGift');
// Script/newBie/NewBieGift.js

"use strict";

var Utils = require("Utils");

var ShareSdk = require("ShareSdk");

var GetTimeString = function GetTimeString() {
  var data = new Date();
  var time = data.getFullYear() + "/" + (data.getMonth() + 1) + "/" + data.getDate(); // var time = data.toLocaleDateString();

  var arr = time.split("/");
  return [time, arr];
};

cc.Class({
  "extends": cc.Component,
  properties: {
    m_n_newpanel: cc.Node,
    m_n_newpanel_success: cc.Node,
    m_btn_getreward: cc.Button,
    m_l_desc: cc.Label
  },
  // LIFE-CYCLE CALLBACKS:
  // onLoad () {},
  start: function start() {
    this.m_n_newpanel.active = false;
    this.m_n_newpanel_success.active = false; // EVENT_LISTENER.on(window.GAME_SAVE_HANDLER, this.updateData, this);

    EVENT_LISTENER.on(window.ON_SHOW_BACK, this.onshowback, this);
    this.updateData();
  },
  // update (dt) {},
  onEnable: function onEnable() {},
  onDisable: function onDisable() {},
  onDestroy: function onDestroy() {
    // EVENT_LISTENER.off(window.GAME_SAVE_HANDLER, this);
    EVENT_LISTENER.off(window.ON_SHOW_BACK, this);
  },
  onshowback: function onshowback(time) {
    if (this._onshowback) {
      this._onshowback = false;

      if (this.m_n_newpanel_success.active) {
        this.m_n_newpanel_success.active = false;
      }
    }
  },
  autoShowRewardPage: function autoShowRewardPage() {
    // 上次领取的时间
    var state = this.getState();

    if (state == 1) {
      if (!window.firststart) {
        this.onBtnNewBieClick();
        window.firststart = true;
      }
    }
  },
  getState: function getState() {
    var state = 1;
    var getTime = window.INIT_GAME_SAVE_DATA.login_time; // console.log("getstate",getTime)

    if (getTime && getTime != 'null' && getTime != '') {
      var getArr = getTime.split("/");
      var temp = GetTimeString();
      var curTime = temp[0],
          curArr = temp[1]; // console.log(getArr, temp[1])

      state = this.judgeTime(getArr, curArr);
    }

    return state;
  },
  judgeTime: function judgeTime(t_a1, t_a2) {
    if (parseInt(t_a1[0]) < parseInt(t_a2[0])) return 1;
    if (parseInt(t_a1[0]) > parseInt(t_a2[0])) return -1;
    if (parseInt(t_a1[1]) < parseInt(t_a2[1])) return 1;
    if (parseInt(t_a1[1]) > parseInt(t_a2[1])) return -1;
    var res = 0;
    if (parseInt(t_a1[2]) < parseInt(t_a2[2])) res = 1;else if (parseInt(t_a1[2]) > parseInt(t_a2[2])) res = -1;
    return res;
  },
  updateData: function updateData() {
    // let state = window.INIT_GAME_SAVE_DATA.award_list % 10;
    // let tt = this.m_btn_getreward.node.getChildByName("l_newbconfirm");
    this.autoShowRewardPage();
    var state = this.getState();

    if (state == 1) {
      this.m_btn_getreward.interactable = true;
      this.m_l_desc.string = "每天可领一次";
    } else {
      this.m_btn_getreward.interactable = false;
      this.m_l_desc.string = "每天可领一次(已领取)";
    }
  },
  onBtnNewBieClick: function onBtnNewBieClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    this.m_n_newpanel.active = true; // let tt = this.m_btn_getreward.node.getChildByName("l_newbconfirm");

    var state = this.getState();

    if (state == 1) {
      this.m_btn_getreward.interactable = true;
      this.m_l_desc.string = "每天可领一次";
    } else {
      this.m_btn_getreward.interactable = false;
      this.m_l_desc.string = "每天可领一次(已领取)";
    }
  },
  onBackBtnClick: function onBackBtnClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    this.m_n_newpanel.active = false;
    this.m_n_newpanel_success.active = false;
  },
  onRewardBackBtnClick: function onRewardBackBtnClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    this.m_n_newpanel.active = false;
    this.m_n_newpanel_success.active = false;
  },
  onBtnGetRewardClick: function onBtnGetRewardClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    this.m_n_newpanel.active = false;
    this.m_n_newpanel_success.active = true;
    var temp = GetTimeString();
    var curTime = temp[0];
    this._onshowback = true;
    window.INIT_GAME_SAVE_DATA.login_time = curTime;
    window.INIT_GAME_SAVE_DATA.tool[0] += 1;
    window.INIT_GAME_SAVE_DATA.gold_num += 10;
    this.updateData();
    if (window.GAME_MENU) window.GAME_MENU.updateGold();
  },
  onShareBtnClick: function onShareBtnClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    var self = this;
    ShareSdk.shareAppMessage({
      title: "炸弹，金币每天领，快来领取吧",
      imageUrl: window.tempFileURL[0],
      success: function success(res) {
        // cc.director.loadScene(window.GAME_SCENE_NAME);
        self.m_n_sharenode.active = true;
      },
      fail: function fail(err) {},
      complate: function complate(msg) {}
    });
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxuZXdCaWVcXE5ld0JpZUdpZnQuanMiXSwibmFtZXMiOlsiVXRpbHMiLCJyZXF1aXJlIiwiU2hhcmVTZGsiLCJHZXRUaW1lU3RyaW5nIiwiZGF0YSIsIkRhdGUiLCJ0aW1lIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJhcnIiLCJzcGxpdCIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwibV9uX25ld3BhbmVsIiwiTm9kZSIsIm1fbl9uZXdwYW5lbF9zdWNjZXNzIiwibV9idG5fZ2V0cmV3YXJkIiwiQnV0dG9uIiwibV9sX2Rlc2MiLCJMYWJlbCIsInN0YXJ0IiwiYWN0aXZlIiwiRVZFTlRfTElTVEVORVIiLCJvbiIsIndpbmRvdyIsIk9OX1NIT1dfQkFDSyIsIm9uc2hvd2JhY2siLCJ1cGRhdGVEYXRhIiwib25FbmFibGUiLCJvbkRpc2FibGUiLCJvbkRlc3Ryb3kiLCJvZmYiLCJfb25zaG93YmFjayIsImF1dG9TaG93UmV3YXJkUGFnZSIsInN0YXRlIiwiZ2V0U3RhdGUiLCJmaXJzdHN0YXJ0Iiwib25CdG5OZXdCaWVDbGljayIsImdldFRpbWUiLCJJTklUX0dBTUVfU0FWRV9EQVRBIiwibG9naW5fdGltZSIsImdldEFyciIsInRlbXAiLCJjdXJUaW1lIiwiY3VyQXJyIiwianVkZ2VUaW1lIiwidF9hMSIsInRfYTIiLCJwYXJzZUludCIsInJlcyIsImludGVyYWN0YWJsZSIsInN0cmluZyIsIlNldFNvdW5kRWZmZWN0IiwiQlVUVE9OX0NMSUNLX01VU0lDIiwib25CYWNrQnRuQ2xpY2siLCJvblJld2FyZEJhY2tCdG5DbGljayIsIm9uQnRuR2V0UmV3YXJkQ2xpY2siLCJ0b29sIiwiZ29sZF9udW0iLCJHQU1FX01FTlUiLCJ1cGRhdGVHb2xkIiwib25TaGFyZUJ0bkNsaWNrIiwic2VsZiIsInNoYXJlQXBwTWVzc2FnZSIsInRpdGxlIiwiaW1hZ2VVcmwiLCJ0ZW1wRmlsZVVSTCIsInN1Y2Nlc3MiLCJtX25fc2hhcmVub2RlIiwiZmFpbCIsImVyciIsImNvbXBsYXRlIiwibXNnIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLEtBQUssR0FBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBbkI7O0FBQ0EsSUFBSUMsUUFBUSxHQUFHRCxPQUFPLENBQUMsVUFBRCxDQUF0Qjs7QUFDQSxJQUFJRSxhQUFhLEdBQUcsU0FBaEJBLGFBQWdCLEdBQVk7QUFDNUIsTUFBSUMsSUFBSSxHQUFHLElBQUlDLElBQUosRUFBWDtBQUNBLE1BQUlDLElBQUksR0FBR0YsSUFBSSxDQUFDRyxXQUFMLEtBQXFCLEdBQXJCLElBQTRCSCxJQUFJLENBQUNJLFFBQUwsS0FBa0IsQ0FBOUMsSUFBbUQsR0FBbkQsR0FBeURKLElBQUksQ0FBQ0ssT0FBTCxFQUFwRSxDQUY0QixDQUc1Qjs7QUFDQSxNQUFJQyxHQUFHLEdBQUdKLElBQUksQ0FBQ0ssS0FBTCxDQUFXLEdBQVgsQ0FBVjtBQUNBLFNBQU8sQ0FBQ0wsSUFBRCxFQUFPSSxHQUFQLENBQVA7QUFDSCxDQU5EOztBQU9BRSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsWUFBWSxFQUFFSixFQUFFLENBQUNLLElBRFQ7QUFFUkMsSUFBQUEsb0JBQW9CLEVBQUVOLEVBQUUsQ0FBQ0ssSUFGakI7QUFHUkUsSUFBQUEsZUFBZSxFQUFFUCxFQUFFLENBQUNRLE1BSFo7QUFJUkMsSUFBQUEsUUFBUSxFQUFFVCxFQUFFLENBQUNVO0FBSkwsR0FIUDtBQVVMO0FBRUE7QUFFQUMsRUFBQUEsS0FkSyxtQkFjRztBQUNKLFNBQUtQLFlBQUwsQ0FBa0JRLE1BQWxCLEdBQTJCLEtBQTNCO0FBQ0EsU0FBS04sb0JBQUwsQ0FBMEJNLE1BQTFCLEdBQW1DLEtBQW5DLENBRkksQ0FHSjs7QUFDQUMsSUFBQUEsY0FBYyxDQUFDQyxFQUFmLENBQWtCQyxNQUFNLENBQUNDLFlBQXpCLEVBQXVDLEtBQUtDLFVBQTVDLEVBQXdELElBQXhEO0FBQ0EsU0FBS0MsVUFBTDtBQUNILEdBcEJJO0FBc0JMO0FBQ0FDLEVBQUFBLFFBdkJLLHNCQXVCTSxDQUVWLENBekJJO0FBMkJMQyxFQUFBQSxTQUFTLEVBQUUscUJBQVksQ0FFdEIsQ0E3Qkk7QUErQkxDLEVBQUFBLFNBL0JLLHVCQStCTztBQUNSO0FBQ0FSLElBQUFBLGNBQWMsQ0FBQ1MsR0FBZixDQUFtQlAsTUFBTSxDQUFDQyxZQUExQixFQUF3QyxJQUF4QztBQUNILEdBbENJO0FBb0NMQyxFQUFBQSxVQXBDSyxzQkFvQ012QixJQXBDTixFQW9DWTtBQUNiLFFBQUksS0FBSzZCLFdBQVQsRUFBc0I7QUFDbEIsV0FBS0EsV0FBTCxHQUFtQixLQUFuQjs7QUFDQSxVQUFJLEtBQUtqQixvQkFBTCxDQUEwQk0sTUFBOUIsRUFBc0M7QUFDbEMsYUFBS04sb0JBQUwsQ0FBMEJNLE1BQTFCLEdBQW1DLEtBQW5DO0FBQ0g7QUFDSjtBQUNKLEdBM0NJO0FBNkNMWSxFQUFBQSxrQkE3Q0ssZ0NBNkNnQjtBQUNqQjtBQUNBLFFBQUlDLEtBQUssR0FBRyxLQUFLQyxRQUFMLEVBQVo7O0FBQ0EsUUFBSUQsS0FBSyxJQUFJLENBQWIsRUFBZ0I7QUFDWixVQUFJLENBQUNWLE1BQU0sQ0FBQ1ksVUFBWixFQUF3QjtBQUNwQixhQUFLQyxnQkFBTDtBQUNBYixRQUFBQSxNQUFNLENBQUNZLFVBQVAsR0FBb0IsSUFBcEI7QUFDSDtBQUNKO0FBQ0osR0F0REk7QUF3RExELEVBQUFBLFFBeERLLHNCQXdETTtBQUNQLFFBQUlELEtBQUssR0FBRyxDQUFaO0FBRUEsUUFBSUksT0FBTyxHQUFHZCxNQUFNLENBQUNlLG1CQUFQLENBQTJCQyxVQUF6QyxDQUhPLENBSVA7O0FBQ0EsUUFBSUYsT0FBTyxJQUFJQSxPQUFPLElBQUksTUFBdEIsSUFBZ0NBLE9BQU8sSUFBSSxFQUEvQyxFQUFtRDtBQUMvQyxVQUFJRyxNQUFNLEdBQUdILE9BQU8sQ0FBQzlCLEtBQVIsQ0FBYyxHQUFkLENBQWI7QUFDQSxVQUFJa0MsSUFBSSxHQUFHMUMsYUFBYSxFQUF4QjtBQUNBLFVBQUkyQyxPQUFPLEdBQUdELElBQUksQ0FBQyxDQUFELENBQWxCO0FBQUEsVUFBdUJFLE1BQU0sR0FBR0YsSUFBSSxDQUFDLENBQUQsQ0FBcEMsQ0FIK0MsQ0FJL0M7O0FBQ0FSLE1BQUFBLEtBQUssR0FBRyxLQUFLVyxTQUFMLENBQWVKLE1BQWYsRUFBdUJHLE1BQXZCLENBQVI7QUFDSDs7QUFDRCxXQUFPVixLQUFQO0FBQ0gsR0FyRUk7QUF1RUxXLEVBQUFBLFNBQVMsRUFBRSxtQkFBVUMsSUFBVixFQUFnQkMsSUFBaEIsRUFBc0I7QUFDN0IsUUFBSUMsUUFBUSxDQUFDRixJQUFJLENBQUMsQ0FBRCxDQUFMLENBQVIsR0FBb0JFLFFBQVEsQ0FBQ0QsSUFBSSxDQUFDLENBQUQsQ0FBTCxDQUFoQyxFQUNJLE9BQU8sQ0FBUDtBQUNKLFFBQUlDLFFBQVEsQ0FBQ0YsSUFBSSxDQUFDLENBQUQsQ0FBTCxDQUFSLEdBQW9CRSxRQUFRLENBQUNELElBQUksQ0FBQyxDQUFELENBQUwsQ0FBaEMsRUFDSSxPQUFPLENBQUMsQ0FBUjtBQUNKLFFBQUlDLFFBQVEsQ0FBQ0YsSUFBSSxDQUFDLENBQUQsQ0FBTCxDQUFSLEdBQW9CRSxRQUFRLENBQUNELElBQUksQ0FBQyxDQUFELENBQUwsQ0FBaEMsRUFDSSxPQUFPLENBQVA7QUFDSixRQUFJQyxRQUFRLENBQUNGLElBQUksQ0FBQyxDQUFELENBQUwsQ0FBUixHQUFvQkUsUUFBUSxDQUFDRCxJQUFJLENBQUMsQ0FBRCxDQUFMLENBQWhDLEVBQ0ksT0FBTyxDQUFDLENBQVI7QUFDSixRQUFJRSxHQUFHLEdBQUcsQ0FBVjtBQUNBLFFBQUlELFFBQVEsQ0FBQ0YsSUFBSSxDQUFDLENBQUQsQ0FBTCxDQUFSLEdBQW9CRSxRQUFRLENBQUNELElBQUksQ0FBQyxDQUFELENBQUwsQ0FBaEMsRUFDSUUsR0FBRyxHQUFHLENBQU4sQ0FESixLQUVLLElBQUlELFFBQVEsQ0FBQ0YsSUFBSSxDQUFDLENBQUQsQ0FBTCxDQUFSLEdBQW9CRSxRQUFRLENBQUNELElBQUksQ0FBQyxDQUFELENBQUwsQ0FBaEMsRUFDREUsR0FBRyxHQUFHLENBQUMsQ0FBUDtBQUNKLFdBQU9BLEdBQVA7QUFDSCxHQXRGSTtBQXdGTHRCLEVBQUFBLFVBeEZLLHdCQXdGUTtBQUNUO0FBQ0E7QUFDQSxTQUFLTSxrQkFBTDtBQUNBLFFBQUlDLEtBQUssR0FBRyxLQUFLQyxRQUFMLEVBQVo7O0FBQ0EsUUFBSUQsS0FBSyxJQUFJLENBQWIsRUFBZ0I7QUFDWixXQUFLbEIsZUFBTCxDQUFxQmtDLFlBQXJCLEdBQW9DLElBQXBDO0FBQ0EsV0FBS2hDLFFBQUwsQ0FBY2lDLE1BQWQsR0FBdUIsUUFBdkI7QUFDSCxLQUhELE1BR087QUFDSCxXQUFLbkMsZUFBTCxDQUFxQmtDLFlBQXJCLEdBQW9DLEtBQXBDO0FBQ0EsV0FBS2hDLFFBQUwsQ0FBY2lDLE1BQWQsR0FBdUIsYUFBdkI7QUFDSDtBQUNKLEdBcEdJO0FBc0dMZCxFQUFBQSxnQkF0R0ssOEJBc0djO0FBQ2Z4QyxJQUFBQSxLQUFLLENBQUN1RCxjQUFOLENBQXFCNUIsTUFBTSxDQUFDNkIsa0JBQTVCLEVBQWdELEtBQWhELEVBQXVELENBQXZEO0FBQ0EsU0FBS3hDLFlBQUwsQ0FBa0JRLE1BQWxCLEdBQTJCLElBQTNCLENBRmUsQ0FHZjs7QUFDQSxRQUFJYSxLQUFLLEdBQUcsS0FBS0MsUUFBTCxFQUFaOztBQUNBLFFBQUlELEtBQUssSUFBSSxDQUFiLEVBQWdCO0FBQ1osV0FBS2xCLGVBQUwsQ0FBcUJrQyxZQUFyQixHQUFvQyxJQUFwQztBQUNBLFdBQUtoQyxRQUFMLENBQWNpQyxNQUFkLEdBQXVCLFFBQXZCO0FBQ0gsS0FIRCxNQUdPO0FBQ0gsV0FBS25DLGVBQUwsQ0FBcUJrQyxZQUFyQixHQUFvQyxLQUFwQztBQUNBLFdBQUtoQyxRQUFMLENBQWNpQyxNQUFkLEdBQXVCLGFBQXZCO0FBQ0g7QUFDSixHQWxISTtBQW9ITEcsRUFBQUEsY0FwSEssNEJBb0hZO0FBQ2J6RCxJQUFBQSxLQUFLLENBQUN1RCxjQUFOLENBQXFCNUIsTUFBTSxDQUFDNkIsa0JBQTVCLEVBQWdELEtBQWhELEVBQXVELENBQXZEO0FBQ0EsU0FBS3hDLFlBQUwsQ0FBa0JRLE1BQWxCLEdBQTJCLEtBQTNCO0FBQ0EsU0FBS04sb0JBQUwsQ0FBMEJNLE1BQTFCLEdBQW1DLEtBQW5DO0FBQ0gsR0F4SEk7QUEwSExrQyxFQUFBQSxvQkExSEssa0NBMEhrQjtBQUNuQjFELElBQUFBLEtBQUssQ0FBQ3VELGNBQU4sQ0FBcUI1QixNQUFNLENBQUM2QixrQkFBNUIsRUFBZ0QsS0FBaEQsRUFBdUQsQ0FBdkQ7QUFDQSxTQUFLeEMsWUFBTCxDQUFrQlEsTUFBbEIsR0FBMkIsS0FBM0I7QUFDQSxTQUFLTixvQkFBTCxDQUEwQk0sTUFBMUIsR0FBbUMsS0FBbkM7QUFDSCxHQTlISTtBQWdJTG1DLEVBQUFBLG1CQWhJSyxpQ0FnSWlCO0FBQ2xCM0QsSUFBQUEsS0FBSyxDQUFDdUQsY0FBTixDQUFxQjVCLE1BQU0sQ0FBQzZCLGtCQUE1QixFQUFnRCxLQUFoRCxFQUF1RCxDQUF2RDtBQUNBLFNBQUt4QyxZQUFMLENBQWtCUSxNQUFsQixHQUEyQixLQUEzQjtBQUNBLFNBQUtOLG9CQUFMLENBQTBCTSxNQUExQixHQUFtQyxJQUFuQztBQUNBLFFBQUlxQixJQUFJLEdBQUcxQyxhQUFhLEVBQXhCO0FBQ0EsUUFBSTJDLE9BQU8sR0FBR0QsSUFBSSxDQUFDLENBQUQsQ0FBbEI7QUFDQSxTQUFLVixXQUFMLEdBQW1CLElBQW5CO0FBQ0FSLElBQUFBLE1BQU0sQ0FBQ2UsbUJBQVAsQ0FBMkJDLFVBQTNCLEdBQXdDRyxPQUF4QztBQUVBbkIsSUFBQUEsTUFBTSxDQUFDZSxtQkFBUCxDQUEyQmtCLElBQTNCLENBQWdDLENBQWhDLEtBQXNDLENBQXRDO0FBQ0FqQyxJQUFBQSxNQUFNLENBQUNlLG1CQUFQLENBQTJCbUIsUUFBM0IsSUFBdUMsRUFBdkM7QUFFQSxTQUFLL0IsVUFBTDtBQUNBLFFBQUlILE1BQU0sQ0FBQ21DLFNBQVgsRUFDSW5DLE1BQU0sQ0FBQ21DLFNBQVAsQ0FBaUJDLFVBQWpCO0FBQ1AsR0EvSUk7QUFpSkxDLEVBQUFBLGVBakpLLDZCQWlKYTtBQUNkaEUsSUFBQUEsS0FBSyxDQUFDdUQsY0FBTixDQUFxQjVCLE1BQU0sQ0FBQzZCLGtCQUE1QixFQUFnRCxLQUFoRCxFQUF1RCxDQUF2RDtBQUNBLFFBQUlTLElBQUksR0FBRyxJQUFYO0FBQ0EvRCxJQUFBQSxRQUFRLENBQUNnRSxlQUFULENBQXlCO0FBQ3JCQyxNQUFBQSxLQUFLLEVBQUUsZ0JBRGM7QUFFckJDLE1BQUFBLFFBQVEsRUFBRXpDLE1BQU0sQ0FBQzBDLFdBQVAsQ0FBbUIsQ0FBbkIsQ0FGVztBQUdyQkMsTUFBQUEsT0FBTyxFQUFFLGlCQUFBbEIsR0FBRyxFQUFJO0FBQ1o7QUFDQWEsUUFBQUEsSUFBSSxDQUFDTSxhQUFMLENBQW1CL0MsTUFBbkIsR0FBNEIsSUFBNUI7QUFDSCxPQU5vQjtBQU9yQmdELE1BQUFBLElBQUksRUFBRSxjQUFBQyxHQUFHLEVBQUksQ0FFWixDQVRvQjtBQVVyQkMsTUFBQUEsUUFBUSxFQUFFLGtCQUFBQyxHQUFHLEVBQUksQ0FFaEI7QUFab0IsS0FBekI7QUFjSDtBQWxLSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgVXRpbHMgPSByZXF1aXJlKFwiVXRpbHNcIik7XG52YXIgU2hhcmVTZGsgPSByZXF1aXJlKFwiU2hhcmVTZGtcIik7XG52YXIgR2V0VGltZVN0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IG5ldyBEYXRlKClcbiAgICB2YXIgdGltZSA9IGRhdGEuZ2V0RnVsbFllYXIoKSArIFwiL1wiICsgKGRhdGEuZ2V0TW9udGgoKSArIDEpICsgXCIvXCIgKyBkYXRhLmdldERhdGUoKTtcbiAgICAvLyB2YXIgdGltZSA9IGRhdGEudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG4gICAgbGV0IGFyciA9IHRpbWUuc3BsaXQoXCIvXCIpO1xuICAgIHJldHVybiBbdGltZSwgYXJyXTtcbn07XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBtX25fbmV3cGFuZWw6IGNjLk5vZGUsXG4gICAgICAgIG1fbl9uZXdwYW5lbF9zdWNjZXNzOiBjYy5Ob2RlLFxuICAgICAgICBtX2J0bl9nZXRyZXdhcmQ6IGNjLkJ1dHRvbixcbiAgICAgICAgbV9sX2Rlc2M6IGNjLkxhYmVsLFxuICAgIH0sXG5cbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcblxuICAgIC8vIG9uTG9hZCAoKSB7fSxcblxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLm1fbl9uZXdwYW5lbC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX25fbmV3cGFuZWxfc3VjY2Vzcy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgLy8gRVZFTlRfTElTVEVORVIub24od2luZG93LkdBTUVfU0FWRV9IQU5ETEVSLCB0aGlzLnVwZGF0ZURhdGEsIHRoaXMpO1xuICAgICAgICBFVkVOVF9MSVNURU5FUi5vbih3aW5kb3cuT05fU0hPV19CQUNLLCB0aGlzLm9uc2hvd2JhY2ssIHRoaXMpO1xuICAgICAgICB0aGlzLnVwZGF0ZURhdGEoKTtcbiAgICB9LFxuXG4gICAgLy8gdXBkYXRlIChkdCkge30sXG4gICAgb25FbmFibGUoKSB7XG5cbiAgICB9LFxuXG4gICAgb25EaXNhYmxlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgb25EZXN0cm95KCkge1xuICAgICAgICAvLyBFVkVOVF9MSVNURU5FUi5vZmYod2luZG93LkdBTUVfU0FWRV9IQU5ETEVSLCB0aGlzKTtcbiAgICAgICAgRVZFTlRfTElTVEVORVIub2ZmKHdpbmRvdy5PTl9TSE9XX0JBQ0ssIHRoaXMpO1xuICAgIH0sXG5cbiAgICBvbnNob3diYWNrKHRpbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuX29uc2hvd2JhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uc2hvd2JhY2sgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbl9uZXdwYW5lbF9zdWNjZXNzLmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubV9uX25ld3BhbmVsX3N1Y2Nlc3MuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgYXV0b1Nob3dSZXdhcmRQYWdlKCkge1xuICAgICAgICAvLyDkuIrmrKHpooblj5bnmoTml7bpl7RcbiAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICBpZiAoc3RhdGUgPT0gMSkge1xuICAgICAgICAgICAgaWYgKCF3aW5kb3cuZmlyc3RzdGFydCkge1xuICAgICAgICAgICAgICAgIHRoaXMub25CdG5OZXdCaWVDbGljaygpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5maXJzdHN0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRTdGF0ZSgpIHtcbiAgICAgICAgdmFyIHN0YXRlID0gMTtcblxuICAgICAgICB2YXIgZ2V0VGltZSA9IHdpbmRvdy5JTklUX0dBTUVfU0FWRV9EQVRBLmxvZ2luX3RpbWU7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZ2V0c3RhdGVcIixnZXRUaW1lKVxuICAgICAgICBpZiAoZ2V0VGltZSAmJiBnZXRUaW1lICE9ICdudWxsJyAmJiBnZXRUaW1lICE9ICcnKSB7XG4gICAgICAgICAgICB2YXIgZ2V0QXJyID0gZ2V0VGltZS5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IEdldFRpbWVTdHJpbmcoKTtcbiAgICAgICAgICAgIHZhciBjdXJUaW1lID0gdGVtcFswXSwgY3VyQXJyID0gdGVtcFsxXVxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZ2V0QXJyLCB0ZW1wWzFdKVxuICAgICAgICAgICAgc3RhdGUgPSB0aGlzLmp1ZGdlVGltZShnZXRBcnIsIGN1ckFycilcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgfSxcblxuICAgIGp1ZGdlVGltZTogZnVuY3Rpb24gKHRfYTEsIHRfYTIpIHtcbiAgICAgICAgaWYgKHBhcnNlSW50KHRfYTFbMF0pIDwgcGFyc2VJbnQodF9hMlswXSkpXG4gICAgICAgICAgICByZXR1cm4gMVxuICAgICAgICBpZiAocGFyc2VJbnQodF9hMVswXSkgPiBwYXJzZUludCh0X2EyWzBdKSlcbiAgICAgICAgICAgIHJldHVybiAtMVxuICAgICAgICBpZiAocGFyc2VJbnQodF9hMVsxXSkgPCBwYXJzZUludCh0X2EyWzFdKSlcbiAgICAgICAgICAgIHJldHVybiAxXG4gICAgICAgIGlmIChwYXJzZUludCh0X2ExWzFdKSA+IHBhcnNlSW50KHRfYTJbMV0pKVxuICAgICAgICAgICAgcmV0dXJuIC0xXG4gICAgICAgIGxldCByZXMgPSAwXG4gICAgICAgIGlmIChwYXJzZUludCh0X2ExWzJdKSA8IHBhcnNlSW50KHRfYTJbMl0pKVxuICAgICAgICAgICAgcmVzID0gMVxuICAgICAgICBlbHNlIGlmIChwYXJzZUludCh0X2ExWzJdKSA+IHBhcnNlSW50KHRfYTJbMl0pKVxuICAgICAgICAgICAgcmVzID0gLTFcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgIH0sXG5cbiAgICB1cGRhdGVEYXRhKCkge1xuICAgICAgICAvLyBsZXQgc3RhdGUgPSB3aW5kb3cuSU5JVF9HQU1FX1NBVkVfREFUQS5hd2FyZF9saXN0ICUgMTA7XG4gICAgICAgIC8vIGxldCB0dCA9IHRoaXMubV9idG5fZ2V0cmV3YXJkLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJsX25ld2Jjb25maXJtXCIpO1xuICAgICAgICB0aGlzLmF1dG9TaG93UmV3YXJkUGFnZSgpO1xuICAgICAgICBsZXQgc3RhdGUgPSB0aGlzLmdldFN0YXRlKCk7XG4gICAgICAgIGlmIChzdGF0ZSA9PSAxKSB7XG4gICAgICAgICAgICB0aGlzLm1fYnRuX2dldHJld2FyZC5pbnRlcmFjdGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5tX2xfZGVzYy5zdHJpbmcgPSBcIuavj+WkqeWPr+mihuS4gOasoVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX2J0bl9nZXRyZXdhcmQuaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm1fbF9kZXNjLnN0cmluZyA9IFwi5q+P5aSp5Y+v6aKG5LiA5qyhKOW3sumihuWPlilcIjtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkJ0bk5ld0JpZUNsaWNrKCkge1xuICAgICAgICBVdGlscy5TZXRTb3VuZEVmZmVjdCh3aW5kb3cuQlVUVE9OX0NMSUNLX01VU0lDLCBmYWxzZSwgMSk7XG4gICAgICAgIHRoaXMubV9uX25ld3BhbmVsLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIC8vIGxldCB0dCA9IHRoaXMubV9idG5fZ2V0cmV3YXJkLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJsX25ld2Jjb25maXJtXCIpO1xuICAgICAgICBsZXQgc3RhdGUgPSB0aGlzLmdldFN0YXRlKCk7XG4gICAgICAgIGlmIChzdGF0ZSA9PSAxKSB7XG4gICAgICAgICAgICB0aGlzLm1fYnRuX2dldHJld2FyZC5pbnRlcmFjdGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5tX2xfZGVzYy5zdHJpbmcgPSBcIuavj+WkqeWPr+mihuS4gOasoVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tX2J0bl9nZXRyZXdhcmQuaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm1fbF9kZXNjLnN0cmluZyA9IFwi5q+P5aSp5Y+v6aKG5LiA5qyhKOW3sumihuWPlilcIjtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkJhY2tCdG5DbGljaygpIHtcbiAgICAgICAgVXRpbHMuU2V0U291bmRFZmZlY3Qod2luZG93LkJVVFRPTl9DTElDS19NVVNJQywgZmFsc2UsIDEpO1xuICAgICAgICB0aGlzLm1fbl9uZXdwYW5lbC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX25fbmV3cGFuZWxfc3VjY2Vzcy5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgb25SZXdhcmRCYWNrQnRuQ2xpY2soKSB7XG4gICAgICAgIFV0aWxzLlNldFNvdW5kRWZmZWN0KHdpbmRvdy5CVVRUT05fQ0xJQ0tfTVVTSUMsIGZhbHNlLCAxKTtcbiAgICAgICAgdGhpcy5tX25fbmV3cGFuZWwuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9uX25ld3BhbmVsX3N1Y2Nlc3MuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIG9uQnRuR2V0UmV3YXJkQ2xpY2soKSB7XG4gICAgICAgIFV0aWxzLlNldFNvdW5kRWZmZWN0KHdpbmRvdy5CVVRUT05fQ0xJQ0tfTVVTSUMsIGZhbHNlLCAxKTtcbiAgICAgICAgdGhpcy5tX25fbmV3cGFuZWwuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9uX25ld3BhbmVsX3N1Y2Nlc3MuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdmFyIHRlbXAgPSBHZXRUaW1lU3RyaW5nKCk7XG4gICAgICAgIHZhciBjdXJUaW1lID0gdGVtcFswXTtcbiAgICAgICAgdGhpcy5fb25zaG93YmFjayA9IHRydWU7XG4gICAgICAgIHdpbmRvdy5JTklUX0dBTUVfU0FWRV9EQVRBLmxvZ2luX3RpbWUgPSBjdXJUaW1lO1xuXG4gICAgICAgIHdpbmRvdy5JTklUX0dBTUVfU0FWRV9EQVRBLnRvb2xbMF0gKz0gMTtcbiAgICAgICAgd2luZG93LklOSVRfR0FNRV9TQVZFX0RBVEEuZ29sZF9udW0gKz0gMTA7XG5cbiAgICAgICAgdGhpcy51cGRhdGVEYXRhKCk7XG4gICAgICAgIGlmICh3aW5kb3cuR0FNRV9NRU5VKVxuICAgICAgICAgICAgd2luZG93LkdBTUVfTUVOVS51cGRhdGVHb2xkKCk7XG4gICAgfSxcblxuICAgIG9uU2hhcmVCdG5DbGljaygpIHtcbiAgICAgICAgVXRpbHMuU2V0U291bmRFZmZlY3Qod2luZG93LkJVVFRPTl9DTElDS19NVVNJQywgZmFsc2UsIDEpO1xuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIFNoYXJlU2RrLnNoYXJlQXBwTWVzc2FnZSh7XG4gICAgICAgICAgICB0aXRsZTogXCLngrjlvLnvvIzph5HluIHmr4/lpKnpoobvvIzlv6vmnaXpooblj5blkKdcIixcbiAgICAgICAgICAgIGltYWdlVXJsOiB3aW5kb3cudGVtcEZpbGVVUkxbMF0sXG4gICAgICAgICAgICBzdWNjZXNzOiByZXMgPT4ge1xuICAgICAgICAgICAgICAgIC8vIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSh3aW5kb3cuR0FNRV9TQ0VORV9OQU1FKTtcbiAgICAgICAgICAgICAgICBzZWxmLm1fbl9zaGFyZW5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmYWlsOiBlcnIgPT4ge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29tcGxhdGU6IG1zZyA9PiB7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH0sXG59KTtcbiJdfQ==